<!DOCTYPE html>
<html>
<head>
  <title>Admin Panel</title>
  <style>
    body {
      font-family: Arial;
      background: #111;
      color: white;
      padding: 30px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }

    th, td {
      padding: 12px;
      border-bottom: 1px solid #333;
      text-align: left;
    }

    th {
      background: #222;
    }

    tr:hover {
      background: #1a1a1a;
    }

    .pending {
      color: orange;
      font-weight: bold;
    }

    .approved {
      color: lime;
      font-weight: bold;
    }

    button {
      padding: 6px 12px;
      border: none;
      background: #00aa00;
      color: white;
      cursor: pointer;
      border-radius: 4px;
    }

    button:hover {
      background: #00cc00;
    }
  </style>
</head>

<body>

<h1>‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô - ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏á‡∏¥‡∏ô</h1>
<div id="orders"></div>

<script>
const BASE_URL = "https://topup-backend-xxxx.onrender.com"; // üî¥ ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì

async function loadOrders() {
  const res = await fetch(BASE_URL + "/orders");
  const orders = await res.json();

  const container = document.getElementById("orders");
  container.innerHTML = "";

  orders.forEach(order => {
    container.innerHTML += `
      <div style="border:1px solid black; padding:10px; margin:10px;">
        <p><b>Email:</b> ${order.email}</p>
        <p><b>‡∏¢‡∏≠‡∏î‡πÄ‡∏ï‡∏¥‡∏°:</b> ${order.originalAmount} ‡∏ö‡∏≤‡∏ó</p>
        <p><b>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</b> ${order.status}</p>

        ${order.slip ? 
          `<button onclick="viewSlip('${order.slip}')">‡∏î‡∏π‡∏™‡∏•‡∏¥‡∏õ</button>` 
          : `<p style="color:red;">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏•‡∏¥‡∏õ</p>`
        }

        ${order.status === "pending" ? 
          `<br><br><button onclick="approve('${order._id}')">‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</button>` 
          : `<p style="color:green;">‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß</p>`
        }
      </div>
    `;
  });
}

function viewSlip(filename) {
  window.open(BASE_URL + "/uploads/" + filename, "_blank");
}

async function approve(id) {
  await fetch(BASE_URL + "/approve/" + id, {
    method: "POST"
  });

  alert("‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢");
  loadOrders();
}

loadOrders();
</script>

</body>
</html>
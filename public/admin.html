<!DOCTYPE html>
<html>
<head>
  <title>Admin Panel</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f6f9;
      margin: 0;
      padding: 20px;
    }

    h1 {
      text-align: center;
    }

    .card {
      background: white;
      padding: 20px;
      margin: 15px auto;
      border-radius: 12px;
      max-width: 600px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }

    .status-pending {
      color: orange;
      font-weight: bold;
    }

    .status-approved {
      color: green;
      font-weight: bold;
    }

    button {
      padding: 8px 15px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      margin-right: 10px;
      font-weight: bold;
    }

    .btn-slip {
      background: #3498db;
      color: white;
    }

    .btn-approve {
      background: #2ecc71;
      color: white;
    }

    .btn-slip:hover {
      background: #2980b9;
    }

    .btn-approve:hover {
      background: #27ae60;
    }
  </style>
</head>
<body>

<h1>üí∞ ‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô - ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏á‡∏¥‡∏ô</h1>
<div id="orders"></div>

<script>
const BASE_URL = "https://topup-backend-1egx.onrender.com"; // üî¥ ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì

async function loadOrders() {
  const res = await fetch(BASE_URL + "/orders");
  const orders = await res.json();

  const container = document.getElementById("orders");
  container.innerHTML = "";

  orders.forEach(order => {
    container.innerHTML += `
      <div class="card">
        <p><b>Email:</b> ${order.email}</p>
        <p><b>‡∏¢‡∏≠‡∏î‡πÄ‡∏ï‡∏¥‡∏°:</b> ${order.originalAmount} ‡∏ö‡∏≤‡∏ó</p>
        <p><b>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</b> 
          <span class="${order.status === "approved" ? "status-approved" : "status-pending"}">
            ${order.status}
          </span>
        </p>

        ${order.slip ? 
          `<button class="btn-slip" onclick="viewSlip('${order.slip}')">‡∏î‡∏π‡∏™‡∏•‡∏¥‡∏õ</button>` 
          : `<p style="color:red;">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏•‡∏¥‡∏õ</p>`
        }

        ${order.status === "pending" ? 
          `<button class="btn-approve" onclick="approve('${order._id}')">‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</button>` 
          : ""
        }
      </div>
    `;
  });
}

function viewSlip(filename) {
  window.open(BASE_URL + "/uploads/" + filename, "_blank");
}

async function approve(id) {
  await fetch(BASE_URL + "/approve/" + id, {
    method: "POST"
  });

  alert("‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢");
  loadOrders();
}

loadOrders();
</script>

</body>
</html>